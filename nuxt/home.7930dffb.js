import{a as C,i as k,o as v,b as x,e as w,j as E,u as i,k as M,C as R,s as B,r as H,w as U,l as I,m as P,p as h,q as A,D as N,v as S,x as z,y as G,c as Y,f as T,z as $,A as L,B as F,T as K,E as J}from"./entry.73393c10.js";var c=(a=>(a[a.Month=0]="Month",a[a.HalfYear=1]="HalfYear",a[a.Year=2]="Year",a))(c||{});const Q={class:"w-full flex justify-around font-bold pt-6 pb-2"},W=C({__name:"TimeframeSelection",setup(a){const e=k("activeTimeframe",()=>c.Month);return(r,t)=>(v(),x("div",Q,[w("span",{class:E(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[i(e)===i(c).Month?"before:w-full !text-white":"before:w-0"]]),onClick:t[0]||(t[0]=n=>e.value=i(c).Month)}," last month ",2),w("span",{class:E(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[i(e)===i(c).HalfYear?"before:w-full !text-white":"before:w-0"]]),onClick:t[1]||(t[1]=n=>e.value=i(c).HalfYear)}," last 6 months ",2),w("span",{class:E(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[i(e)===i(c).Year?"before:w-full !text-white":"before:w-0"]]),onClick:t[2]||(t[2]=n=>e.value=i(c).Year)}," last year ",2)]))}}),X=M(W,[["__scopeId","data-v-e7d2fb3c"]]),Z={},V={class:"bg-purple w-full h-full rounded-md"};function ee(a,e){return v(),x("div",V,"Purple Placeholder")}const te=M(Z,[["render",ee]]);var g;(function(a){a.ChartRendered="chart:rendered",a.ChartUpdated="chart:updated",a.ChartDestroyed="chart:destroyed",a.LabelsUpdated="labels:updated"})(g||(g={}));function D(a,e,r,t){a(e,r),t!==void 0&&t.emit(g.ChartRendered)}function ae(a,e){a.update(),e!==void 0&&e.emit(g.ChartUpdated)}function O(a,e){a.destroy(),e!==void 0&&e.emit(g.ChartDestroyed)}function ne(a,e){const r={labels:typeof a.labels>"u"?[]:[...a.labels],datasets:[]};return q(r,{...a},e),r}function q(a,e,r){const t=[];a.datasets=e.datasets.map(n=>{const s=a.datasets.find(o=>o[r]===n[r]);return!s||!n.data||t.includes(s)?{...n}:(t.push(s),Object.assign(s,n),s)})}function re(a,e,r){a.data.labels=e,r!==void 0&&r.emit(g.LabelsUpdated)}function se(a,e){a.options={...e}}function oe(a,e){const r=a.datasets.map(n=>n.label),t=e.datasets.map(n=>n.label);return e.datasets.length===a.datasets.length&&r.every((n,s)=>n===t[s])}const le="Please remove the <template></template> tags from your chart component. See https://vue-chartjs.org/guide/#vue-single-file-components",ie="Update ERROR: chart instance not found",ce=(a,e,r)=>C({props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>{}},datasetIdKey:{type:String,default:"label"},chartId:{type:String,default:a},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{type:String,default:""},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]}},setup(t,n){R.register(r);const s=B(null),o=H(null);function u(l,d){if(s.value!==null&&O(h(s.value),n),o.value===null)throw new Error(le);{const m=ne(l,t.datasetIdKey),y=o.value.getContext("2d");y!==null&&(s.value=new R(y,{type:e,data:S(l)?new Proxy(m,{}):m,options:d,plugins:t.plugins}))}}function f(l,d){const m=S(l)?h(l):{...l},y=S(d)?h(d):{...d};if(Object.keys(y).length>0){const _=h(s.value);oe(m,y)&&_!==null?(q(_==null?void 0:_.data,m,t.datasetIdKey),m.labels!==void 0&&re(_,m.labels,n),b()):(_!==null&&O(_,n),D(u,t.chartData,t.chartOptions,n))}else s.value!==null&&O(h(s.value),n),D(u,t.chartData,t.chartOptions,n)}function p(l){const d=h(s.value);d!==null?(se(d,l),b()):D(u,t.chartData,t.chartOptions,n)}function b(){const l=h(s.value);l!==null?ae(l,n):console.error(ie)}return U(()=>t.chartData,(l,d)=>f(l,d),{deep:!0}),U(()=>t.chartOptions,l=>p(l),{deep:!0}),I(()=>{"datasets"in t.chartData&&t.chartData.datasets.length>0&&D(u,t.chartData,t.chartOptions,n)}),P(()=>{s.value!==null&&O(h(s.value),n)}),n.expose({chart:s,updateChart:b}),()=>A("div",{style:t.styles,class:t.cssClasses},[A("canvas",{id:t.chartId,width:t.width,height:t.height,ref:o})])}}),ue=ce("doughnut-chart","doughnut",N),de=C({__name:"Doughnut",props:{doughnutData:{default:()=>[{name:"Missing Data",count:1}]}},setup(a){const e=a;R.register(...z);const{doughnutData:r}=G(e),t={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"white"}}}},n={labels:[],datasets:[{backgroundColor:["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],borderColor:"#191414",data:[]}]};return r.value.forEach(s=>{n.labels.push(s.name),n.datasets[0].data.push(s.count)}),(s,o)=>(v(),Y(i(ue),{"chart-data":n,"chart-options":t}))}});function j({endpoint:a,query:e,body:r,method:t}){const n=localStorage.getItem("auth-token");if(!n)throw T("/login"),new Error("missing authorization token");const s=new URL(`https://api.spotify.com/v1${a}`);return e&&Object.entries(e).forEach(([o,u])=>s.searchParams.append(o,u)),fetch(s,{method:t!=null?t:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:r?JSON.stringify(r):void 0}).then(o=>{if(o.ok)return o.json();if(o.status===403)throw T("/login"),new Error("Recieved '403 Forbidden' response from Spotify");return o.text()}).then(o=>{if(o.error)throw new Error(o.error);return o})}const fe={class:"w-full h-full flex flex-col justify-center items-center"},he=w("h1",{class:"text-[30px] pb-6"},"Your Favorite Genres",-1),pe=C({__name:"GenreDoughnut",async setup(a){var o;let e,r;const t=k("activeTimeframe").value,n={[c.Month]:([e,r]=$(()=>j({endpoint:"/me/top/artists",query:{time_range:"short_term"}}).catch(console.error)),e=await e,r(),e),[c.HalfYear]:([e,r]=$(()=>j({endpoint:"/me/top/artists",query:{time_range:"medium_term"}}).catch(console.error)),e=await e,r(),e),[c.Year]:([e,r]=$(()=>j({endpoint:"/me/top/artists",query:{time_range:"long_term"}}).catch(console.error)),e=await e,r(),e)},s=[];return(o=n[t])==null||o.items.forEach(u=>u.genres.forEach(f=>{s.length>=20||(s.some(p=>p.name===f)?s.find(p=>p.name===f).count++:s.push({name:f,count:1}))})),(u,f)=>(v(),x("section",fe,[he,L(de,{"doughnut-data":s})]))}}),me={class:"flex justify-center items-center h-[80vh] w-full p-5"},_e=C({__name:"home",setup(a){const r=k("currentSlide",()=>0),t=k("activeTimeframe",()=>c.Month),n=()=>{r.value++,r.value>=2&&(r.value=0)};return(s,o)=>{const u=X,f=te,p=pe;return v(),x("section",null,[L(u),w("div",me,[L(K,{name:"statistics",mode:"out-in"},{default:F(()=>[i(r)===0?(v(),Y(f,{key:i(t)+"purple",onClick:o[0]||(o[0]=b=>n())})):i(r)===1?(v(),Y(p,{key:i(t)+"genreDoughnut",onClick:o[1]||(o[1]=b=>n())})):J("",!0)]),_:1})])])}}});const be=M(_e,[["__scopeId","data-v-41281d58"]]);export{be as default};
