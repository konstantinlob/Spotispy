import{_ as R}from"./_plugin-vue_export-helper.af303bb4.js";import{o as p,b as x,a as w,C as S,s as B,r as H,w as Y,i as I,j as A,k as d,l as L,D as q,m as j,p as N,q as P,c as T,u as c,f as M,v as O,x as z,y as $,e as y,z as k,A as G,T as K,B as F}from"./entry.6e54203e.js";const J={},Q={class:"bg-purple w-full h-full rounded-md"};function W(a,t){return p(),x("div",Q,"Purple Placeholder")}const X=R(J,[["render",W]]);var v;(function(a){a.ChartRendered="chart:rendered",a.ChartUpdated="chart:updated",a.ChartDestroyed="chart:destroyed",a.LabelsUpdated="labels:updated"})(v||(v={}));function C(a,t,o,e){a(t,o),e!==void 0&&e.emit(v.ChartRendered)}function Z(a,t){a.update(),t!==void 0&&t.emit(v.ChartUpdated)}function D(a,t){a.destroy(),t!==void 0&&t.emit(v.ChartDestroyed)}function V(a,t){const o={labels:typeof a.labels>"u"?[]:[...a.labels],datasets:[]};return U(o,{...a},t),o}function U(a,t,o){const e=[];a.datasets=t.datasets.map(n=>{const r=a.datasets.find(s=>s[o]===n[o]);return!r||!n.data||e.includes(r)?{...n}:(e.push(r),Object.assign(r,n),r)})}function ee(a,t,o){a.data.labels=t,o!==void 0&&o.emit(v.LabelsUpdated)}function te(a,t){a.options={...t}}function ae(a,t){const o=a.datasets.map(n=>n.label),e=t.datasets.map(n=>n.label);return t.datasets.length===a.datasets.length&&o.every((n,r)=>n===e[r])}const ne="Please remove the <template></template> tags from your chart component. See https://vue-chartjs.org/guide/#vue-single-file-components",se="Update ERROR: chart instance not found",re=(a,t,o)=>w({props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>{}},datasetIdKey:{type:String,default:"label"},chartId:{type:String,default:a},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{type:String,default:""},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]}},setup(e,n){S.register(o);const r=B(null),s=H(null);function i(l,f){if(r.value!==null&&D(d(r.value),n),s.value===null)throw new Error(ne);{const h=V(l,e.datasetIdKey),b=s.value.getContext("2d");b!==null&&(r.value=new S(b,{type:t,data:j(l)?new Proxy(h,{}):h,options:f,plugins:e.plugins}))}}function m(l,f){const h=j(l)?d(l):{...l},b=j(f)?d(f):{...f};if(Object.keys(b).length>0){const _=d(r.value);ae(h,b)&&_!==null?(U(_==null?void 0:_.data,h,e.datasetIdKey),h.labels!==void 0&&ee(_,h.labels,n),E()):(_!==null&&D(_,n),C(i,e.chartData,e.chartOptions,n))}else r.value!==null&&D(d(r.value),n),C(i,e.chartData,e.chartOptions,n)}function g(l){const f=d(r.value);f!==null?(te(f,l),E()):C(i,e.chartData,e.chartOptions,n)}function E(){const l=d(r.value);l!==null?Z(l,n):console.error(se)}return Y(()=>e.chartData,(l,f)=>m(l,f),{deep:!0}),Y(()=>e.chartOptions,l=>g(l),{deep:!0}),I(()=>{"datasets"in e.chartData&&e.chartData.datasets.length>0&&C(i,e.chartData,e.chartOptions,n)}),A(()=>{r.value!==null&&D(d(r.value),n)}),n.expose({chart:r,updateChart:E}),()=>L("div",{style:e.styles,class:e.cssClasses},[L("canvas",{id:e.chartId,width:e.width,height:e.height,ref:s})])}}),oe=re("doughnut-chart","doughnut",q),le=w({__name:"Doughnut",props:{doughnutData:{default:()=>[{name:"Missing Data",count:1}]}},setup(a){const t=a;S.register(...N);const{doughnutData:o}=P(t),e={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"white"}}}},n={labels:[],datasets:[{backgroundColor:["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],borderColor:"#191414",data:[]}]};return o.value.forEach(r=>{n.labels.push(r.name),n.datasets[0].data.push(r.count)}),(r,s)=>(p(),T(c(oe),{"chart-data":n,"chart-options":e}))}});function ie({endpoint:a,query:t,body:o,method:e}){const n=localStorage.getItem("auth-token");if(!n)throw M("/login"),new Error("missing authorization token");const r=new URL(`https://api.spotify.com/v1${a}`);return t&&Object.entries(t).forEach(([s,i])=>r.searchParams.append(s,i)),fetch(r,{method:e!=null?e:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:o?JSON.stringify(o):void 0}).then(s=>{if(s.status===204)return null;if(s.status===403||s.status===401)throw M("/login"),new Error(s.status+": "+s.statusText);return s.json()}).then(s=>{var i;if(s!=null&&s.error)throw(i=s.error)!=null&&i.status?new Error(s.error.status+": "+s.error.message):new Error(s.error+": "+s.error_description);return s})}var u=(a=>(a[a.Month=0]="Month",a[a.HalfYear=1]="HalfYear",a[a.Year=2]="Year",a))(u||{});const ce={class:"w-full h-full flex flex-col justify-center items-center"},ue=y("h1",{class:"text-[30px] pb-6"},"Your Favorite Genres",-1),fe=w({__name:"GenreDoughnut",async setup(a){let t,o;const e=O("activeTimeframe").value,n={[u.Month]:"short_term",[u.HalfYear]:"medium_term",[u.Year]:"long_term"},r=([t,o]=z(()=>ie({endpoint:"/me/top/artists",query:{time_range:n[e]}}).catch(console.error)),t=await t,o(),t),s=[];return r==null||r.items.forEach(i=>i.genres.forEach(m=>{s.length>=20||(s.some(g=>g.name===m)?s.find(g=>g.name===m).count++:s.push({name:m,count:1}))})),(i,m)=>(p(),x("section",ce,[ue,$(le,{"doughnut-data":s})]))}}),de={class:"w-full flex justify-around font-bold pt-6 pb-2"},he=w({__name:"TimeframeSelection",setup(a){const t=O("activeTimeframe",()=>u.Month);return(o,e)=>(p(),x("div",de,[y("span",{class:k(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[c(t)===c(u).Month?"before:w-full !text-white":"before:w-0"]]),onClick:e[0]||(e[0]=n=>t.value=c(u).Month)}," last month ",2),y("span",{class:k(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[c(t)===c(u).HalfYear?"before:w-full !text-white":"before:w-0"]]),onClick:e[1]||(e[1]=n=>t.value=c(u).HalfYear)}," last 6 months ",2),y("span",{class:k(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[c(t)===c(u).Year?"before:w-full !text-white":"before:w-0"]]),onClick:e[2]||(e[2]=n=>t.value=c(u).Year)}," last year ",2)]))}}),_e=R(he,[["__scopeId","data-v-e7d2fb3c"]]),me={class:"flex justify-center items-center h-[80vh] w-full p-5"},pe=w({__name:"home",setup(a){const t=O("currentSlide",()=>0),o=O("activeTimeframe",()=>u.Month),e=[X,fe],n=()=>{t.value++,t.value>=e.length&&(t.value=0)};return(r,s)=>{const i=_e;return p(),x("section",null,[$(i),y("div",me,[$(K,{name:"statistics",mode:"out-in"},{default:G(()=>[(p(),T(F(e[c(t)]),{key:c(o),onClick:n}))]),_:1})])])}}});const ye=R(pe,[["__scopeId","data-v-b52526c0"]]);export{ye as default};
