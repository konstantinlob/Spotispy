import{a as v,C as O,s as q,r as N,w as L,i as z,j as F,k as m,l as Y,D as G,R as P,m as R,p as U,q as K,o as g,c as S,u,f as A,v as D,x as $,b as j,y as E,e as b,z as T,A as J,T as W,B as Z}from"./entry.4c2c60ce.js";import{_ as H}from"./_plugin-vue_export-helper.af303bb4.js";var y;(function(a){a.ChartRendered="chart:rendered",a.ChartUpdated="chart:updated",a.ChartDestroyed="chart:destroyed",a.LabelsUpdated="labels:updated"})(y||(y={}));function k(a,e,o,t){a(e,o),t!==void 0&&t.emit(y.ChartRendered)}function Q(a,e){a.update(),e!==void 0&&e.emit(y.ChartUpdated)}function x(a,e){a.destroy(),e!==void 0&&e.emit(y.ChartDestroyed)}function X(a,e){const o={labels:typeof a.labels>"u"?[]:[...a.labels],datasets:[]};return M(o,{...a},e),o}function M(a,e,o){const t=[];a.datasets=e.datasets.map(r=>{const n=a.datasets.find(s=>s[o]===r[o]);return!n||!r.data||t.includes(n)?{...r}:(t.push(n),Object.assign(n,r),n)})}function V(a,e,o){a.data.labels=e,o!==void 0&&o.emit(y.LabelsUpdated)}function ee(a,e){a.options={...e}}function te(a,e){const o=a.datasets.map(r=>r.label),t=e.datasets.map(r=>r.label);return e.datasets.length===a.datasets.length&&o.every((r,n)=>r===t[n])}const ae="Please remove the <template></template> tags from your chart component. See https://vue-chartjs.org/guide/#vue-single-file-components",re="Update ERROR: chart instance not found",I=(a,e,o)=>v({props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>{}},datasetIdKey:{type:String,default:"label"},chartId:{type:String,default:a},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{type:String,default:""},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]}},setup(t,r){O.register(o);const n=q(null),s=N(null);function i(l,c){if(n.value!==null&&x(m(n.value),r),s.value===null)throw new Error(ae);{const p=X(l,t.datasetIdKey),w=s.value.getContext("2d");w!==null&&(n.value=new O(w,{type:e,data:R(l)?new Proxy(p,{}):p,options:c,plugins:t.plugins}))}}function d(l,c){const p=R(l)?m(l):{...l},w=R(c)?m(c):{...c};if(Object.keys(w).length>0){const _=m(n.value);te(p,w)&&_!==null?(M(_==null?void 0:_.data,p,t.datasetIdKey),p.labels!==void 0&&V(_,p.labels,r),C()):(_!==null&&x(_,r),k(i,t.chartData,t.chartOptions,r))}else n.value!==null&&x(m(n.value),r),k(i,t.chartData,t.chartOptions,r)}function h(l){const c=m(n.value);c!==null?(ee(c,l),C()):k(i,t.chartData,t.chartOptions,r)}function C(){const l=m(n.value);l!==null?Q(l,r):console.error(re)}return L(()=>t.chartData,(l,c)=>d(l,c),{deep:!0}),L(()=>t.chartOptions,l=>h(l),{deep:!0}),z(()=>{"datasets"in t.chartData&&t.chartData.datasets.length>0&&k(i,t.chartData,t.chartOptions,r)}),F(()=>{n.value!==null&&x(m(n.value),r)}),r.expose({chart:n,updateChart:C}),()=>Y("div",{style:t.styles,class:t.cssClasses},[Y("canvas",{id:t.chartId,width:t.width,height:t.height,ref:s})])}}),se=I("doughnut-chart","doughnut",G),ne=I("radar-chart","radar",P),oe=v({__name:"Doughnut",props:{doughnutData:{default:()=>[{name:"Missing Data",count:1}]}},setup(a){const e=a;O.register(...U);const{doughnutData:o}=K(e),t={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"white"}}}},r={labels:[],datasets:[{backgroundColor:["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],borderColor:"#191414",data:[]}]};return o.value.forEach(n=>{r.labels.push(n.name),r.datasets[0].data.push(n.count)}),(n,s)=>(g(),S(u(se),{"chart-data":r,"chart-options":t}))}});function B({endpoint:a,query:e,body:o,method:t}){const r=localStorage.getItem("auth-token");if(!r)throw A("/login"),new Error("missing authorization token");const n=new URL(`https://api.spotify.com/v1${a}`);return e&&Object.entries(e).forEach(([s,i])=>n.searchParams.append(s,i)),fetch(n,{method:t!=null?t:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:o?JSON.stringify(o):void 0}).then(s=>{if(s.status===204)return null;if(s.status===403||s.status===401)throw A("/login"),new Error(s.status+": "+s.statusText);return s.json()}).then(s=>{var i;if(s!=null&&s.error)throw(i=s.error)!=null&&i.status?new Error(s.error.status+": "+s.error.message):new Error(s.error+": "+s.error_description);return s})}var f=(a=>(a[a.Month=0]="Month",a[a.HalfYear=1]="HalfYear",a[a.Year=2]="Year",a))(f||{});const le={class:"w-full h-full flex flex-col justify-center items-center"},ie=b("h1",{class:"text-[30px] pb-6"},"Your Favorite Genres",-1),ce=v({__name:"GenreDoughnut",async setup(a){let e,o;const t=D("activeTimeframe").value,r={[f.Month]:"short_term",[f.HalfYear]:"medium_term",[f.Year]:"long_term"},n=([e,o]=$(()=>B({endpoint:"/me/top/artists",query:{time_range:r[t]}}).catch(console.error)),e=await e,o(),e),s=[];return n==null||n.items.forEach(i=>i.genres.forEach(d=>{s.length>=20||(s.some(h=>h.name===d)?s.find(h=>h.name===d).count++:s.push({name:d,count:1}))})),(i,d)=>(g(),j("section",le,[ie,E(oe,{"doughnut-data":s})]))}}),ue=v({__name:"RadarChart",props:{data:null},setup(a){const e=a;O.register(...U);const o={plugins:{legend:{display:!1}},scales:{r:{angleLines:{display:!1},beginAtZero:!0,pointLabels:{display:!0,color:"white"},ticks:{display:!1},grid:{display:!0,color:"gray"}}}},t="#1DB954",r="#1DB95444",n="#eeeeee",s={labels:[],datasets:[{data:[],fill:!0,borderWidth:3,backgroundColor:r,borderColor:t,pointBackgroundColor:t,pointBorderColor:n,pointHoverBackgroundColor:n,pointHoverBorderColor:n}]};return e.data.forEach(i=>{var d;(d=s.labels)==null||d.push(i.name),s.datasets[0].data.push(i.value)}),(i,d)=>(g(),S(u(ne),{"chart-data":s,"chart-options":o}))}}),de={class:"w-full h-full flex flex-col justify-center items-center"},fe=b("h1",{class:"text-[30px] pb-6"},"Your Top Tracks Analysed",-1),he=v({__name:"AudioFeatures",async setup(a){let e,o;const t=D("activeTimeframe");function r(){return t.value===0?"short_term":t.value===1?"medium_term":t.value===2?"long_term":"medium_term"}const s=([e,o]=$(()=>B({endpoint:"/me/top/tracks",query:{limit:50,time_range:r()}})),e=await e,o(),e).items.map(l=>l.id),i=([e,o]=$(()=>B({endpoint:"/audio-features",query:{ids:s.join(",")}})),e=await e,o(),e);let d=0;const h={acousticness:0,danceability:0,energy:0,instrumentalness:0,liveness:0,speechiness:0,valence:0};i.audio_features.forEach(l=>{d+=1,Object.keys(h).forEach(c=>{h[c]+=l[c]})});const C=Object.entries(h).map(([l,c])=>({name:l.toUpperCase(),value:c/d}));return(l,c)=>{const p=ue;return g(),j("section",de,[fe,E(p,{data:u(C)},null,8,["data"])])}}}),pe={class:"w-full flex justify-around font-bold pt-6 pb-2"},me=v({__name:"TimeframeSelection",setup(a){const e=D("activeTimeframe",()=>f.Month);return(o,t)=>(g(),j("div",pe,[b("span",{class:T(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(e)===u(f).Month?"before:w-full !text-white":"before:w-0"]]),onClick:t[0]||(t[0]=r=>e.value=u(f).Month)}," last month ",2),b("span",{class:T(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(e)===u(f).HalfYear?"before:w-full !text-white":"before:w-0"]]),onClick:t[1]||(t[1]=r=>e.value=u(f).HalfYear)}," last 6 months ",2),b("span",{class:T(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(e)===u(f).Year?"before:w-full !text-white":"before:w-0"]]),onClick:t[2]||(t[2]=r=>e.value=u(f).Year)}," last year ",2)]))}}),_e=H(me,[["__scopeId","data-v-e7d2fb3c"]]),ge={class:"flex justify-center items-center h-[80vh] w-full p-5"},ve=v({__name:"home",setup(a){const e=D("currentSlide",()=>0),o=D("activeTimeframe",()=>f.Month),t=[ce,he],r=()=>{e.value++,e.value>=t.length&&(e.value=0)};return(n,s)=>{const i=_e;return g(),j("section",null,[E(i),b("div",ge,[E(W,{name:"statistics",mode:"out-in"},{default:J(()=>[(g(),S(Z(t[u(e)]),{key:u(o),onClick:r}))]),_:1})])])}}});const we=H(ve,[["__scopeId","data-v-f932172c"]]);export{we as default};
