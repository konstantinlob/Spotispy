import{a as $,C as M,s as N,r as z,w as L,i as G,j as A,k as w,l as R,D as F,m as T,p as J,q as K,o as v,c as q,u,f as U,v as x,x as B,b,y as P,e as h,z as j,A as Q,B as E,E as Y,F as W,G as X,T as Z,H as V}from"./entry.67fa0ab4.js";import{_ as I}from"./_plugin-vue_export-helper.af303bb4.js";var k;(function(a){a.ChartRendered="chart:rendered",a.ChartUpdated="chart:updated",a.ChartDestroyed="chart:destroyed",a.LabelsUpdated="labels:updated"})(k||(k={}));function O(a,t,l,e){a(t,l),e!==void 0&&e.emit(k.ChartRendered)}function ee(a,t){a.update(),t!==void 0&&t.emit(k.ChartUpdated)}function S(a,t){a.destroy(),t!==void 0&&t.emit(k.ChartDestroyed)}function te(a,t){const l={labels:typeof a.labels>"u"?[]:[...a.labels],datasets:[]};return H(l,{...a},t),l}function H(a,t,l){const e=[];a.datasets=t.datasets.map(n=>{const o=a.datasets.find(s=>s[l]===n[l]);return!o||!n.data||e.includes(o)?{...n}:(e.push(o),Object.assign(o,n),o)})}function ae(a,t,l){a.data.labels=t,l!==void 0&&l.emit(k.LabelsUpdated)}function ne(a,t){a.options={...t}}function se(a,t){const l=a.datasets.map(n=>n.label),e=t.datasets.map(n=>n.label);return t.datasets.length===a.datasets.length&&l.every((n,o)=>n===e[o])}const re="Please remove the <template></template> tags from your chart component. See https://vue-chartjs.org/guide/#vue-single-file-components",oe="Update ERROR: chart instance not found",le=(a,t,l)=>$({props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>{}},datasetIdKey:{type:String,default:"label"},chartId:{type:String,default:a},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{type:String,default:""},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]}},setup(e,n){M.register(l);const o=N(null),s=z(null);function i(d,m){if(o.value!==null&&S(w(o.value),n),s.value===null)throw new Error(re);{const r=te(d,e.datasetIdKey),c=s.value.getContext("2d");c!==null&&(o.value=new M(c,{type:t,data:T(d)?new Proxy(r,{}):r,options:m,plugins:e.plugins}))}}function p(d,m){const r=T(d)?w(d):{...d},c=T(m)?w(m):{...m};if(Object.keys(c).length>0){const f=w(o.value);se(r,c)&&f!==null?(H(f==null?void 0:f.data,r,e.datasetIdKey),r.labels!==void 0&&ae(f,r.labels,n),C()):(f!==null&&S(f,n),O(i,e.chartData,e.chartOptions,n))}else o.value!==null&&S(w(o.value),n),O(i,e.chartData,e.chartOptions,n)}function g(d){const m=w(o.value);m!==null?(ne(m,d),C()):O(i,e.chartData,e.chartOptions,n)}function C(){const d=w(o.value);d!==null?ee(d,n):console.error(oe)}return L(()=>e.chartData,(d,m)=>p(d,m),{deep:!0}),L(()=>e.chartOptions,d=>g(d),{deep:!0}),G(()=>{"datasets"in e.chartData&&e.chartData.datasets.length>0&&O(i,e.chartData,e.chartOptions,n)}),A(()=>{o.value!==null&&S(w(o.value),n)}),n.expose({chart:o,updateChart:C}),()=>R("div",{style:e.styles,class:e.cssClasses},[R("canvas",{id:e.chartId,width:e.width,height:e.height,ref:s})])}}),ie=le("doughnut-chart","doughnut",F),ce=""+new URL("WAILT_logo.4edaa98f.svg?inline",import.meta.url).href,ue=$({__name:"Doughnut",props:{doughnutData:{default:()=>[{name:"Missing Data",count:1}]}},setup(a){const t=a;M.register(...J);const{doughnutData:l}=K(t),e={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"white"}}}},n=new Image;n.src=ce;const o={id:"background-logo",beforeDraw:i=>{if(n.complete){const p=i.ctx,{top:g,left:C,width:d,height:m}=i.chartArea,r=d/3,c=r,f=C+d/2-r/2,y=g+m/2-c/2;p.drawImage(n,f,y,r,c)}else n.onload=()=>i.draw()}},s={labels:[],datasets:[{backgroundColor:["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],borderColor:"#191414",data:[]}]};return l.value.forEach(i=>{s.labels.push(i.name),s.datasets[0].data.push(i.count)}),(i,p)=>(v(),q(u(ie),{"chart-data":s,"chart-options":e,plugins:[o]},null,8,["plugins"]))}});function D({endpoint:a,query:t,body:l,method:e}){const n=localStorage.getItem("auth-token");if(!n)throw U("/login"),new Error("missing authorization token");const o=new URL(`https://api.spotify.com/v1${a}`);return t&&Object.entries(t).forEach(([s,i])=>o.searchParams.append(s,i)),fetch(o,{method:e!=null?e:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:l?JSON.stringify(l):void 0}).then(s=>{if(s.status===204)return null;if(s.status===401||s.status===403)throw U("/login"),new Error(s.status+": "+s.statusText);return s.json()}).then(s=>{if(s!=null&&s.error)throw s.error.status?new Error(s.error.status+": "+s.error.message):new Error(s.error+": "+s.error_description);return s})}var _=(a=>(a[a.Month=0]="Month",a[a.HalfYear=1]="HalfYear",a[a.Year=2]="Year",a))(_||{});const de={class:"w-full h-full flex flex-col justify-center items-center"},he=h("h1",{class:"text-[30px] pb-6"},"Your Favorite Genres",-1),fe=$({__name:"GenreDoughnut",async setup(a){let t,l;const e=x("activeTimeframe").value,n={[_.Month]:"short_term",[_.HalfYear]:"medium_term",[_.Year]:"long_term"},o=([t,l]=B(()=>D({endpoint:"/me/top/artists",query:{time_range:n[e]}}).catch(console.error)),t=await t,l(),t),s=[];return o==null||o.items.forEach(i=>i.genres.forEach(p=>{s.length>=20||(s.some(g=>g.name===p)?s.find(g=>g.name===p).count++:s.push({name:p,count:1}))})),(i,p)=>(v(),b("section",de,[he,P(ue,{"doughnut-data":s})]))}}),me={},pe={class:"bg-purple w-full h-full rounded-md"};function _e(a,t){return v(),b("div",pe,"Purple Placeholder")}const ge=I(me,[["render",_e]]),ve={class:"w-full flex justify-around font-bold pt-6 pb-2"},ye=$({__name:"TimeframeSelection",setup(a){const t=x("activeTimeframe",()=>_.Month);return(l,e)=>(v(),b("div",ve,[h("span",{class:j(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(t)===u(_).Month?"before:w-full !text-white":"before:w-0"]]),onClick:e[0]||(e[0]=n=>t.value=u(_).Month)}," last month ",2),h("span",{class:j(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(t)===u(_).HalfYear?"before:w-full !text-white":"before:w-0"]]),onClick:e[1]||(e[1]=n=>t.value=u(_).HalfYear)}," last 6 months ",2),h("span",{class:j(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(t)===u(_).Year?"before:w-full !text-white":"before:w-0"]]),onClick:e[2]||(e[2]=n=>t.value=u(_).Year)}," last year ",2)]))}}),be=I(ye,[["__scopeId","data-v-e7d2fb3c"]]),we={key:0,class:"bg-spotify-green bg-opacity-50"},Ce={key:0},De={class:"flex h-16 justify-start"},xe={class:"h-full p-1"},ke=["src"],$e={class:"my-auto"},Ee={class:"text-white"},Oe={class:"text-[#bbb]"},Se={class:"my-auto w-24 text-center self-center"},Pe={key:0,class:"flex align-baseline justify-evenly"},Te={class:"h-1 relative"},je=h("div",{class:"absolute bg-gray h-full w-full"},null,-1),Me={key:1,class:"text-center h-16"},Ie=$({__name:"MusicPlayer",async setup(a){let t,l;const e=x(()=>null,"$y4C0JPT9MN"),n=([t,l]=B(()=>D({endpoint:"/me"})),t=await t,l(),t),o=x(()=>({progress:0,percent:0,fetched:0}),"$pmQmXMhZQP");let s;Q(()=>{g(),s=setInterval(p,250)}),A(()=>{clearInterval(s)});function i(r){if(r===null)return"~:~";const c=Math.floor(r/1e3);return`${Math.floor(c/60)}:${(c%60).toString().padStart(2,"0")}`}function p(){var f,y;const r=e.value;if(!((r==null?void 0:r.progress_ms)&&((f=r==null?void 0:r.item)==null?void 0:f.duration_ms)))return;let c=r.progress_ms;r.is_playing&&(c=r.progress_ms+(Date.now()-o.value.fetched)),o.value={progress:c,percent:c/((y=r.item)==null?void 0:y.duration_ms),fetched:o.value.fetched}}function g(){D({endpoint:"/me/player",query:{additional_types:"track",market:n.country}}).then(r=>{e.value=r,o.value.fetched=Date.now(),setTimeout(()=>g(),2500)}).catch(r=>{console.error(r),setTimeout(()=>g(),1e4)})}function C(){D({endpoint:"/me/player/previous",method:"POST"}).catch(r=>{alert(r.message)})}function d(){e.value!==null&&(e.value.is_playing?D({endpoint:"/me/player/pause",method:"PUT",query:{device_id:e.value.device.id}}).catch(r=>{alert(r.message)}):D({endpoint:"/me/player/play",method:"PUT",query:{device_id:e.value.device.id}}).catch(r=>{alert(r.message)}))}function m(){D({endpoint:"/me/player/next",method:"POST"}).catch(r=>{alert(r.message)})}return(r,c)=>{var f;return v(),b("div",null,[u(e)?(v(),b("div",we,[u(e).item?(v(),b("div",Ce,[h("div",De,[h("div",xe,[h("img",{class:"max-h-full",src:(f=u(e).item.album.images[0])==null?void 0:f.url,alt:"Album Cover"},null,8,ke)]),h("div",$e,[h("p",Ee,E(u(e).item.name),1),h("p",Oe,E(u(e).item.artists.map(y=>y.name).join(", ")),1)]),h("div",Se,[u(n).product==="premium"?(v(),b("div",Pe,[h("button",{onClick:c[0]||(c[0]=y=>C())},"\u23EE"),h("button",{onClick:c[1]||(c[1]=y=>d())},"\u23EF"),h("button",{onClick:c[2]||(c[2]=y=>m())},"\u23ED")])):Y("",!0),h("p",null,E(i(u(o)?u(o).progress:null))+" / "+E(i(u(e).item.duration_ms)),1)])]),h("div",Te,[je,h("div",{class:"absolute bg-white h-full",style:W({width:`${u(o).percent*100}%`})},null,4)])])):(v(),b("div",Me," Ad is playing "))])):Y("",!0)])}}}),Le={class:"flex justify-center items-center h-[80vh] w-full p-5"},Re=$({__name:"home",setup(a){const t=x("currentSlide",()=>0),l=x("activeTimeframe",()=>_.Month),e=[fe,ge],n=()=>{t.value++,t.value>=e.length&&(t.value=0)};return(o,s)=>{const i=be,p=Ie;return v(),b("section",null,[P(i),h("div",Le,[P(Z,{name:"statistics",mode:"out-in"},{default:X(()=>[(v(),q(V(e[u(t)]),{key:u(l),onClick:n}))]),_:1})]),P(p)])}}});const Ae=I(Re,[["__scopeId","data-v-0a401d86"]]);export{Ae as default};
