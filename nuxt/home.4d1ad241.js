import{a as D,C as j,s as W,r as J,i as M,j as K,k as q,l as k,m as A,D as Q,R as Z,p as R,q as Y,v as X,o as v,c as L,u as d,f as B,x,w as P,b as C,y as $,e as u,z as I,A as V,B as E,E as U,F as ee,G as te,T as ae,H as se}from"./entry.2f26497e.js";import{_ as H}from"./_plugin-vue_export-helper.af303bb4.js";var T;(function(a){a.ChartRendered="chart:rendered",a.ChartUpdated="chart:updated",a.ChartDestroyed="chart:destroyed",a.LabelsUpdated="labels:updated"})(T||(T={}));function O(a,t,l,e){a(t,l),e!==void 0&&e.emit(T.ChartRendered)}function ne(a,t){a.update(),t!==void 0&&t.emit(T.ChartUpdated)}function S(a,t){a.destroy(),t!==void 0&&t.emit(T.ChartDestroyed)}function re(a,t){const l={labels:typeof a.labels>"u"?[]:[...a.labels],datasets:[]};return N(l,{...a},t),l}function N(a,t,l){const e=[];a.datasets=t.datasets.map(s=>{const n=a.datasets.find(r=>r[l]===s[l]);return!n||!s.data||e.includes(n)?{...s}:(e.push(n),Object.assign(n,s),n)})}function oe(a,t,l){a.data.labels=t,l!==void 0&&l.emit(T.LabelsUpdated)}function le(a,t){a.options={...t}}function ie(a,t){const l=a.datasets.map(s=>s.label),e=t.datasets.map(s=>s.label);return t.datasets.length===a.datasets.length&&l.every((s,n)=>s===e[n])}const ce="Please remove the <template></template> tags from your chart component. See https://vue-chartjs.org/guide/#vue-single-file-components",ue="Update ERROR: chart instance not found",z=(a,t,l)=>D({props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>{}},datasetIdKey:{type:String,default:"label"},chartId:{type:String,default:a},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{type:String,default:""},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]}},setup(e,s){j.register(l);const n=W(null),r=J(null);function i(c,g){if(n.value!==null&&S(k(n.value),s),r.value===null)throw new Error(ce);{const o=re(c,e.datasetIdKey),h=r.value.getContext("2d");h!==null&&(n.value=new j(h,{type:t,data:R(c)?new Proxy(o,{}):o,options:g,plugins:e.plugins}))}}function f(c,g){const o=R(c)?k(c):{...c},h=R(g)?k(g):{...g};if(Object.keys(h).length>0){const m=k(n.value);ie(o,h)&&m!==null?(N(m==null?void 0:m.data,o,e.datasetIdKey),o.labels!==void 0&&oe(m,o.labels,s),p()):(m!==null&&S(m,s),O(i,e.chartData,e.chartOptions,s))}else n.value!==null&&S(k(n.value),s),O(i,e.chartData,e.chartOptions,s)}function _(c){const g=k(n.value);g!==null?(le(g,c),p()):O(i,e.chartData,e.chartOptions,s)}function p(){const c=k(n.value);c!==null?ne(c,s):console.error(ue)}return M(()=>e.chartData,(c,g)=>f(c,g),{deep:!0}),M(()=>e.chartOptions,c=>_(c),{deep:!0}),K(()=>{"datasets"in e.chartData&&e.chartData.datasets.length>0&&O(i,e.chartData,e.chartOptions,s)}),q(()=>{n.value!==null&&S(k(n.value),s)}),s.expose({chart:n,updateChart:p}),()=>A("div",{style:e.styles,class:e.cssClasses},[A("canvas",{id:e.chartId,width:e.width,height:e.height,ref:r})])}}),de=z("doughnut-chart","doughnut",Q),he=z("radar-chart","radar",Z),fe=""+new URL("WAILT_logo.4edaa98f.svg?inline",import.meta.url).href,pe=D({__name:"Doughnut",props:{doughnutData:{default:()=>[{name:"Missing Data",count:1}]}},setup(a){const t=a;j.register(...Y);const{doughnutData:l}=X(t),e={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"white"}}}},s=new Image;s.src=fe;const n={id:"background-logo",beforeDraw:i=>{if(s.complete){const f=i.ctx,{top:_,left:p,width:c,height:g}=i.chartArea,o=c/3,h=o,m=p+c/2-o/2,y=_+g/2-h/2;f.drawImage(s,m,y,o,h)}else s.onload=()=>i.draw()}},r={labels:[],datasets:[{backgroundColor:["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],borderColor:"#191414",data:[]}]};return l.value.forEach(i=>{r.labels.push(i.name),r.datasets[0].data.push(i.count)}),(i,f)=>(v(),L(d(de),{"chart-data":r,"chart-options":e,plugins:[n]},null,8,["plugins"]))}}),F=a=>a.replace(/(^\w{1})|(\s+\w{1})/g,t=>t.toUpperCase());function w({endpoint:a,query:t,body:l,method:e}){const s=localStorage.getItem("auth-token");if(!s)throw B("/login"),new Error("missing authorization token");const n=new URL(`https://api.spotify.com/v1${a}`);return t&&Object.entries(t).forEach(([r,i])=>n.searchParams.append(r,i)),fetch(n,{method:e!=null?e:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:l?JSON.stringify(l):void 0}).then(r=>{if(r.status===204)return null;if(r.status===401||r.status===403)throw B("/login"),new Error(r.status+": "+r.statusText);return r.json()}).then(r=>{if(r!=null&&r.error)throw r.error.status?new Error(r.error.status+": "+r.error.message):new Error(r.error+": "+r.error_description);return r})}var b=(a=>(a[a.Month=0]="Month",a[a.HalfYear=1]="HalfYear",a[a.Year=2]="Year",a))(b||{});const G={[0]:"short_term",[1]:"medium_term",[2]:"long_term"},me={class:"w-full h-full flex flex-col justify-center items-center"},_e=u("h1",{class:"text-[30px] pb-6"},"Your Favorite Genres",-1),ge=u("p",{class:"text-gray"},"We found to what genres you like",-1),ve=D({__name:"GenreDoughnut",async setup(a){var r;let t,l;const e=x("activeTimeframe").value,s=([t,l]=P(()=>w({endpoint:"/me/top/artists",query:{time_range:G[e]}}).catch(console.error)),t=await t,l(),t),n=[];return(r=s==null?void 0:s.items)==null||r.forEach(i=>i.genres.forEach(f=>{f=F(f);const _=n.find(p=>p.name===f);_?_.count++:n.length<20&&n.push({name:f,count:1})})),(i,f)=>(v(),C("section",me,[_e,$(pe,{"doughnut-data":n}),ge]))}}),ye=D({__name:"RadarChart",props:{data:null},setup(a){const t=a;j.register(...Y);const l={plugins:{legend:{display:!1}},scales:{r:{angleLines:{display:!1},beginAtZero:!0,pointLabels:{display:!0,color:"white"},ticks:{display:!1},grid:{display:!0,color:"gray"}}}},e="#1DB954",s="#1DB95444",n="#eeeeee",r={labels:[],datasets:[{data:[],fill:!0,borderWidth:3,backgroundColor:s,borderColor:e,pointBackgroundColor:e,pointBorderColor:n,pointHoverBackgroundColor:n,pointHoverBorderColor:n}]};return t.data.forEach(i=>{var f;(f=r.labels)==null||f.push(i.name),r.datasets[0].data.push(i.value)}),(i,f)=>(v(),L(d(he),{"chart-data":r,"chart-options":l}))}}),be={class:"w-full h-full flex flex-col justify-center items-center"},we=u("h1",{class:"text-[30px] pb-6"},"Your Top Tracks Analysed",-1),Ce=u("p",{class:"text-gray"},"We analysed your Top Tracks for audio features",-1),ke=D({__name:"AudioFeaturesRadarChart",async setup(a){let t,l;const e=x("activeTimeframe"),n=([t,l]=P(()=>w({endpoint:"/me/top/tracks",query:{limit:50,time_range:G[e.value]}})),t=await t,l(),t).items.map(p=>p.id),r=([t,l]=P(()=>w({endpoint:"/audio-features",query:{ids:n.join(",")}})),t=await t,l(),t),i={acousticness:0,danceability:0,energy:0,instrumentalness:0,liveness:0,speechiness:0,valence:0};r.audio_features.forEach(p=>{Object.keys(i).forEach(c=>{i[c]+=p[c]})});const f=r.audio_features.length,_=Object.entries(i).map(([p,c])=>({name:F(p),value:c/f}));return(p,c)=>(v(),C("section",be,[we,$(ye,{data:d(_)},null,8,["data"]),Ce]))}}),De={class:"w-full flex justify-around font-bold pt-6 pb-2"},xe=D({__name:"TimeframeSelection",setup(a){const t=x("activeTimeframe",()=>b.Month);return(l,e)=>(v(),C("div",De,[u("span",{class:I(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[d(t)===d(b).Month?"before:w-full !text-white":"before:w-0"]]),onClick:e[0]||(e[0]=s=>t.value=d(b).Month)}," last month ",2),u("span",{class:I(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[d(t)===d(b).HalfYear?"before:w-full !text-white":"before:w-0"]]),onClick:e[1]||(e[1]=s=>t.value=d(b).HalfYear)}," last 6 months ",2),u("span",{class:I(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[d(t)===d(b).Year?"before:w-full !text-white":"before:w-0"]]),onClick:e[2]||(e[2]=s=>t.value=d(b).Year)}," last year ",2)]))}}),Te=H(xe,[["__scopeId","data-v-e7d2fb3c"]]),$e={key:0,class:"bg-spotify-green bg-opacity-50"},Ee={key:0},Oe={class:"flex h-16 justify-start"},Se={class:"h-full p-1"},je=["src"],Pe={class:"my-auto"},Re={class:"text-white"},Ie={class:"text-[#bbb]"},Le={class:"my-auto w-24 text-center self-center"},Me={key:0,class:"flex align-baseline justify-evenly"},Ae={class:"h-1 relative"},Be=u("div",{class:"absolute bg-gray h-full w-full"},null,-1),Ue={key:1,class:"text-center h-16"},qe=D({__name:"MusicPlayer",async setup(a){let t,l;const e=x(()=>null,"$y4C0JPT9MN"),s=([t,l]=P(()=>w({endpoint:"/me"})),t=await t,l(),t),n=x(()=>({progress:0,percent:0,fetched:0}),"$pmQmXMhZQP");let r;V(()=>{_(),r=setInterval(f,250)}),q(()=>{clearInterval(r)});function i(o){if(o===null)return"~:~";const h=Math.floor(o/1e3);return`${Math.floor(h/60)}:${(h%60).toString().padStart(2,"0")}`}function f(){var m,y;const o=e.value;if(!((o==null?void 0:o.progress_ms)&&((m=o==null?void 0:o.item)==null?void 0:m.duration_ms)))return;let h=o.progress_ms;o.is_playing&&(h=o.progress_ms+(Date.now()-n.value.fetched)),n.value={progress:h,percent:h/((y=o.item)==null?void 0:y.duration_ms),fetched:n.value.fetched}}function _(){w({endpoint:"/me/player",query:{additional_types:"track",market:s.country}}).then(o=>{e.value=o,n.value.fetched=Date.now(),setTimeout(()=>_(),2500)}).catch(o=>{console.error(o),setTimeout(()=>_(),1e4)})}function p(){w({endpoint:"/me/player/previous",method:"POST"}).catch(o=>{alert(o.message)})}function c(){e.value!==null&&(e.value.is_playing?w({endpoint:"/me/player/pause",method:"PUT",query:{device_id:e.value.device.id}}).catch(o=>{alert(o.message)}):w({endpoint:"/me/player/play",method:"PUT",query:{device_id:e.value.device.id}}).catch(o=>{alert(o.message)}))}function g(){w({endpoint:"/me/player/next",method:"POST"}).catch(o=>{alert(o.message)})}return(o,h)=>{var m;return v(),C("div",null,[d(e)?(v(),C("div",$e,[d(e).item?(v(),C("div",Ee,[u("div",Oe,[u("div",Se,[u("img",{class:"max-h-full",src:(m=d(e).item.album.images[0])==null?void 0:m.url,alt:"Album Cover"},null,8,je)]),u("div",Pe,[u("p",Re,E(d(e).item.name),1),u("p",Ie,E(d(e).item.artists.map(y=>y.name).join(", ")),1)]),u("div",Le,[d(s).product==="premium"?(v(),C("div",Me,[u("button",{onClick:h[0]||(h[0]=y=>p())},"\u23EE"),u("button",{onClick:h[1]||(h[1]=y=>c())},"\u23EF"),u("button",{onClick:h[2]||(h[2]=y=>g())},"\u23ED")])):U("",!0),u("p",null,E(i(d(n)?d(n).progress:null))+" / "+E(i(d(e).item.duration_ms)),1)])]),u("div",Ae,[Be,u("div",{class:"absolute bg-white h-full",style:ee({width:`${d(n).percent*100}%`})},null,4)])])):(v(),C("div",Ue," Ad is playing "))])):U("",!0)])}}}),Ye={class:"flex justify-center items-center h-[80vh] w-full p-5 relative"},He=D({__name:"home",setup(a){const t=x("currentSlide",()=>0),l=x("activeTimeframe",()=>b.Month),e=[ve,ke],s=()=>{t.value++,t.value>=e.length&&(t.value=0)},n=()=>{t.value--,t.value<0&&(t.value=e.length-1)};return(r,i)=>{const f=Te,_=qe;return v(),C("section",null,[$(f),u("div",Ye,[$(ae,{name:"statistics",mode:"out-in"},{default:te(()=>[(v(),L(se(e[d(t)]),{key:d(l)}))]),_:1}),u("div",{class:"absolute flex w-full h-full"},[u("button",{class:"w-1/3 h-full active:hidden",onClick:n}),u("button",{class:"w-2/3 h-full active:hidden",onClick:s})])]),$(_)])}}});const Fe=H(He,[["__scopeId","data-v-2458fd65"]]);export{Fe as default};
