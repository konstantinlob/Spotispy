import{a as D,C as S,s as W,r as J,w as M,i as K,j as q,k,l as A,D as Q,R as Z,m as R,p as Y,q as X,o as v,c as L,u,f as B,v as x,x as P,b as C,y as $,e as h,z as I,A as V,B as E,E as U,F as ee,G as te,T as ae,H as se}from"./entry.4eb12894.js";import{_ as H}from"./_plugin-vue_export-helper.af303bb4.js";var T;(function(a){a.ChartRendered="chart:rendered",a.ChartUpdated="chart:updated",a.ChartDestroyed="chart:destroyed",a.LabelsUpdated="labels:updated"})(T||(T={}));function O(a,t,i,e){a(t,i),e!==void 0&&e.emit(T.ChartRendered)}function ne(a,t){a.update(),t!==void 0&&t.emit(T.ChartUpdated)}function j(a,t){a.destroy(),t!==void 0&&t.emit(T.ChartDestroyed)}function re(a,t){const i={labels:typeof a.labels>"u"?[]:[...a.labels],datasets:[]};return N(i,{...a},t),i}function N(a,t,i){const e=[];a.datasets=t.datasets.map(s=>{const n=a.datasets.find(r=>r[i]===s[i]);return!n||!s.data||e.includes(n)?{...s}:(e.push(n),Object.assign(n,s),n)})}function oe(a,t,i){a.data.labels=t,i!==void 0&&i.emit(T.LabelsUpdated)}function ie(a,t){a.options={...t}}function le(a,t){const i=a.datasets.map(s=>s.label),e=t.datasets.map(s=>s.label);return t.datasets.length===a.datasets.length&&i.every((s,n)=>s===e[n])}const ce="Please remove the <template></template> tags from your chart component. See https://vue-chartjs.org/guide/#vue-single-file-components",ue="Update ERROR: chart instance not found",z=(a,t,i)=>D({props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>{}},datasetIdKey:{type:String,default:"label"},chartId:{type:String,default:a},width:{type:Number,default:400},height:{type:Number,default:400},cssClasses:{type:String,default:""},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]}},setup(e,s){S.register(i);const n=W(null),r=J(null);function l(c,_){if(n.value!==null&&j(k(n.value),s),r.value===null)throw new Error(ce);{const o=re(c,e.datasetIdKey),d=r.value.getContext("2d");d!==null&&(n.value=new S(d,{type:t,data:R(c)?new Proxy(o,{}):o,options:_,plugins:e.plugins}))}}function f(c,_){const o=R(c)?k(c):{...c},d=R(_)?k(_):{..._};if(Object.keys(d).length>0){const m=k(n.value);le(o,d)&&m!==null?(N(m==null?void 0:m.data,o,e.datasetIdKey),o.labels!==void 0&&oe(m,o.labels,s),p()):(m!==null&&j(m,s),O(l,e.chartData,e.chartOptions,s))}else n.value!==null&&j(k(n.value),s),O(l,e.chartData,e.chartOptions,s)}function g(c){const _=k(n.value);_!==null?(ie(_,c),p()):O(l,e.chartData,e.chartOptions,s)}function p(){const c=k(n.value);c!==null?ne(c,s):console.error(ue)}return M(()=>e.chartData,(c,_)=>f(c,_),{deep:!0}),M(()=>e.chartOptions,c=>g(c),{deep:!0}),K(()=>{"datasets"in e.chartData&&e.chartData.datasets.length>0&&O(l,e.chartData,e.chartOptions,s)}),q(()=>{n.value!==null&&j(k(n.value),s)}),s.expose({chart:n,updateChart:p}),()=>A("div",{style:e.styles,class:e.cssClasses},[A("canvas",{id:e.chartId,width:e.width,height:e.height,ref:r})])}}),de=z("doughnut-chart","doughnut",Q),he=z("radar-chart","radar",Z),fe=""+new URL("WAILT_logo.4edaa98f.svg?inline",import.meta.url).href,pe=D({__name:"Doughnut",props:{doughnutData:{default:()=>[{name:"Missing Data",count:1}]}},setup(a){const t=a;S.register(...Y);const{doughnutData:i}=X(t),e={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"white"}}}},s=new Image;s.src=fe;const n={id:"background-logo",beforeDraw:l=>{if(s.complete){const f=l.ctx,{top:g,left:p,width:c,height:_}=l.chartArea,o=c/3,d=o,m=p+c/2-o/2,y=g+_/2-d/2;f.drawImage(s,m,y,o,d)}else s.onload=()=>l.draw()}},r={labels:[],datasets:[{backgroundColor:["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],borderColor:"#191414",data:[]}]};return i.value.forEach(l=>{r.labels.push(l.name),r.datasets[0].data.push(l.count)}),(l,f)=>(v(),L(u(de),{"chart-data":r,"chart-options":e,plugins:[n]},null,8,["plugins"]))}}),F=a=>a.replace(/(^\w{1})|(\s+\w{1})/g,t=>t.toUpperCase());function w({endpoint:a,query:t,body:i,method:e}){const s=localStorage.getItem("auth-token");if(!s)throw B("/login"),new Error("missing authorization token");const n=new URL(`https://api.spotify.com/v1${a}`);return t&&Object.entries(t).forEach(([r,l])=>n.searchParams.append(r,l)),fetch(n,{method:e!=null?e:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:i?JSON.stringify(i):void 0}).then(r=>{if(r.status===204)return null;if(r.status===401||r.status===403)throw B("/login"),new Error(r.status+": "+r.statusText);return r.json()}).then(r=>{if(r!=null&&r.error)throw r.error.status?new Error(r.error.status+": "+r.error.message):new Error(r.error+": "+r.error_description);return r})}var b=(a=>(a[a.Month=0]="Month",a[a.HalfYear=1]="HalfYear",a[a.Year=2]="Year",a))(b||{});const G={[0]:"short_term",[1]:"medium_term",[2]:"long_term"},me={class:"w-full h-full flex flex-col justify-center items-center"},_e=h("h1",{class:"text-[30px] pb-6"},"Your Favorite Genres",-1),ge=h("p",{class:"text-gray"},"We found to what genres you like",-1),ve=D({__name:"GenreDoughnut",async setup(a){var r;let t,i;const e=x("activeTimeframe").value,s=([t,i]=P(()=>w({endpoint:"/me/top/artists",query:{time_range:G[e]}}).catch(console.error)),t=await t,i(),t),n=[];return(r=s==null?void 0:s.items)==null||r.forEach(l=>l.genres.forEach(f=>{f=F(f);const g=n.find(p=>p.name===f);g?g.count++:n.length<20&&n.push({name:f,count:1})})),(l,f)=>(v(),C("section",me,[_e,$(pe,{"doughnut-data":n}),ge]))}}),ye=D({__name:"RadarChart",props:{data:null},setup(a){const t=a;S.register(...Y);const i={plugins:{legend:{display:!1}},scales:{r:{angleLines:{display:!1},beginAtZero:!0,pointLabels:{display:!0,color:"white"},ticks:{display:!1},grid:{display:!0,color:"gray"}}}},e="#1DB954",s="#1DB95444",n="#eeeeee",r={labels:[],datasets:[{data:[],fill:!0,borderWidth:3,backgroundColor:s,borderColor:e,pointBackgroundColor:e,pointBorderColor:n,pointHoverBackgroundColor:n,pointHoverBorderColor:n}]};return t.data.forEach(l=>{var f;(f=r.labels)==null||f.push(l.name),r.datasets[0].data.push(l.value)}),(l,f)=>(v(),L(u(he),{"chart-data":r,"chart-options":i}))}}),be={class:"w-full h-full flex flex-col justify-center items-center"},we=h("h1",{class:"text-[30px] pb-6"},"Your Top Tracks Analysed",-1),Ce=h("p",{class:"text-gray"},"We analysed your Top Tracks for audio features",-1),ke=D({__name:"AudioFeaturesRadarChart",async setup(a){let t,i;const e=x("activeTimeframe"),n=([t,i]=P(()=>w({endpoint:"/me/top/tracks",query:{limit:50,time_range:G[e.value]}})),t=await t,i(),t).items.map(p=>p.id),r=([t,i]=P(()=>w({endpoint:"/audio-features",query:{ids:n.join(",")}})),t=await t,i(),t),l={acousticness:0,danceability:0,energy:0,instrumentalness:0,liveness:0,speechiness:0,valence:0};r.audio_features.forEach(p=>{Object.keys(l).forEach(c=>{l[c]+=p[c]})});const f=r.audio_features.length,g=Object.entries(l).map(([p,c])=>({name:F(p),value:c/f}));return(p,c)=>(v(),C("section",be,[we,$(ye,{data:u(g)},null,8,["data"]),Ce]))}}),De={class:"w-full flex justify-around font-bold pt-6 pb-2"},xe=D({__name:"TimeframeSelection",setup(a){const t=x("activeTimeframe",()=>b.Month);return(i,e)=>(v(),C("div",De,[h("span",{class:I(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(t)===u(b).Month?"before:w-full !text-white":"before:w-0"]]),onClick:e[0]||(e[0]=s=>t.value=u(b).Month)}," last month ",2),h("span",{class:I(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(t)===u(b).HalfYear?"before:w-full !text-white":"before:w-0"]]),onClick:e[1]||(e[1]=s=>t.value=u(b).HalfYear)}," last 6 months ",2),h("span",{class:I(["cursor-pointer relative hidden-green-underline hover:text-spotify-green transition-colors",[u(t)===u(b).Year?"before:w-full !text-white":"before:w-0"]]),onClick:e[2]||(e[2]=s=>t.value=u(b).Year)}," last year ",2)]))}}),Te=H(xe,[["__scopeId","data-v-e7d2fb3c"]]),$e={key:0,class:"bg-spotify-green bg-opacity-50"},Ee={key:0},Oe={class:"flex h-16 justify-start"},je={class:"h-full p-1"},Se=["src"],Pe={class:"my-auto"},Re={class:"text-white"},Ie={class:"text-[#bbb]"},Le={class:"my-auto w-24 text-center self-center"},Me={key:0,class:"flex align-baseline justify-evenly"},Ae={class:"h-1 relative"},Be=h("div",{class:"absolute bg-gray h-full w-full"},null,-1),Ue={key:1,class:"text-center h-16"},qe=D({__name:"MusicPlayer",async setup(a){let t,i;const e=x(()=>null,"$y4C0JPT9MN"),s=([t,i]=P(()=>w({endpoint:"/me"})),t=await t,i(),t),n=x(()=>({progress:0,percent:0,fetched:0}),"$pmQmXMhZQP");let r;V(()=>{g(),r=setInterval(f,250)}),q(()=>{clearInterval(r)});function l(o){if(o===null)return"~:~";const d=Math.floor(o/1e3);return`${Math.floor(d/60)}:${(d%60).toString().padStart(2,"0")}`}function f(){var m,y;const o=e.value;if(!((o==null?void 0:o.progress_ms)&&((m=o==null?void 0:o.item)==null?void 0:m.duration_ms)))return;let d=o.progress_ms;o.is_playing&&(d=o.progress_ms+(Date.now()-n.value.fetched)),n.value={progress:d,percent:d/((y=o.item)==null?void 0:y.duration_ms),fetched:n.value.fetched}}function g(){w({endpoint:"/me/player",query:{additional_types:"track",market:s.country}}).then(o=>{e.value=o,n.value.fetched=Date.now(),setTimeout(()=>g(),2500)}).catch(o=>{console.error(o),setTimeout(()=>g(),1e4)})}function p(){w({endpoint:"/me/player/previous",method:"POST"}).catch(o=>{alert(o.message)})}function c(){e.value!==null&&(e.value.is_playing?w({endpoint:"/me/player/pause",method:"PUT",query:{device_id:e.value.device.id}}).catch(o=>{alert(o.message)}):w({endpoint:"/me/player/play",method:"PUT",query:{device_id:e.value.device.id}}).catch(o=>{alert(o.message)}))}function _(){w({endpoint:"/me/player/next",method:"POST"}).catch(o=>{alert(o.message)})}return(o,d)=>{var m;return v(),C("div",null,[u(e)?(v(),C("div",$e,[u(e).item?(v(),C("div",Ee,[h("div",Oe,[h("div",je,[h("img",{class:"max-h-full",src:(m=u(e).item.album.images[0])==null?void 0:m.url,alt:"Album Cover"},null,8,Se)]),h("div",Pe,[h("p",Re,E(u(e).item.name),1),h("p",Ie,E(u(e).item.artists.map(y=>y.name).join(", ")),1)]),h("div",Le,[u(s).product==="premium"?(v(),C("div",Me,[h("button",{onClick:d[0]||(d[0]=y=>p())},"\u23EE"),h("button",{onClick:d[1]||(d[1]=y=>c())},"\u23EF"),h("button",{onClick:d[2]||(d[2]=y=>_())},"\u23ED")])):U("",!0),h("p",null,E(l(u(n)?u(n).progress:null))+" / "+E(l(u(e).item.duration_ms)),1)])]),h("div",Ae,[Be,h("div",{class:"absolute bg-white h-full",style:ee({width:`${u(n).percent*100}%`})},null,4)])])):(v(),C("div",Ue," Ad is playing "))])):U("",!0)])}}}),Ye={class:"flex justify-center items-center h-[80vh] w-full p-5"},He=D({__name:"home",setup(a){const t=x("currentSlide",()=>0),i=x("activeTimeframe",()=>b.Month),e=[ve,ke],s=()=>{t.value++,t.value>=e.length&&(t.value=0)};return(n,r)=>{const l=Te,f=qe;return v(),C("section",null,[$(l),h("div",Ye,[$(ae,{name:"statistics",mode:"out-in"},{default:te(()=>[(v(),L(se(e[u(t)]),{key:u(i),onClick:s}))]),_:1})]),$(f)])}}});const Fe=H(He,[["__scopeId","data-v-7f0799bf"]]);export{Fe as default};
